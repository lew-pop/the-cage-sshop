{"version":3,"file":"static/js/150.14568b8c.chunk.js","mappings":"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","sources":["pages/CloverPayment.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport React, { Fragment, useEffect, useState } from \"react\";\r\nimport { Link, useParams, useLocation } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getDiscountPrice } from \"../helpers/product\";\r\nimport SEO from \"../components/seo\";\r\nimport LayoutOne from \"../layouts/LayoutOne\";\r\nimport Breadcrumb from \"../wrappers/breadcrumb/Breadcrumb\";\r\nimport {\r\n  useListOrderDetailsQuery,\r\n  usePayOrderMutation,\r\n  useDeliverOrderMutation,\r\n  \r\n} from \"../store/api/order\";\r\n\r\n\r\nconst CloverPayment = () => {\r\n  const dispatch = useDispatch();\r\n  let { pathname } = useLocation();\r\n  let { orderId } = useParams();\r\n\r\n  //const { formData } = pathname.state || {};\r\n // const orderId = formData.orderId;\r\n  const orderDetails = useListOrderDetailsQuery(orderId);\r\n  const { order, error, loading } = orderDetails;\r\n  const [sdkReady, setSdkReady] = useState(false);\r\n  const [clover, setClover] = useState(null);\r\n  const [orderData, setOrderData] = useState({\r\n    _id: \"\",\r\n    source: \"\",\r\n  });\r\n  /*useEffect(() => {\r\n    // Load the Clover SDK script\r\n    const script = document.createElement('script');\r\n    script.src = \"https://checkout.sandbox.dev.clover.com/sdk.js\";\r\n    script.async = true;\r\n    document.body.appendChild(script);\r\n\r\n    return () => {\r\n      document.body.removeChild(script);\r\n    };\r\n  }, []);*/\r\n\r\n  const addCloverScript = () => {\r\n    const script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src = \"https://checkout.sandbox.dev.clover.com/sdk.js\";\r\n    script.async = true;\r\n    script.onload = () => {\r\n      setSdkReady(true);\r\n      initializeClover();\r\n    };\r\n    document.body.appendChild(script);\r\n  };\r\n\r\n  //const Clover = require(\"clover\")(process.env.CLOVER_PUBLIC_KEY);\r\n  const initializeClover = () => {\r\n    const apiKey = process.env.CLOVER_API_KEY;\r\n    const cloverInstance = new window.Clover(apiKey, {\r\n      merchantId: process.env.CLOVER_MERCHANT_ID,\r\n    });\r\n\r\n    setClover(cloverInstance);\r\n    const elements = clover.elements();\r\n\r\n    //create card elements\r\n    const cardNumber = elements.create(\"CARD_NUMBER\");\r\n    const cardName = elements.create(\"CARD_NAME\");\r\n    const cardDate = elements.create(\"CARD_DATE\");\r\n    const cardCvv = elements.create(\"CARD_CVV\");\r\n    const cardPostalCode = elements.create(\"CARD_POSTAL_CODE\");\r\n\r\n    //mount each element\r\n    cardNumber.mount(\"#card-number\");\r\n    cardName.mount(\"#card-name\");\r\n    cardDate.mount(\"#card-date\");\r\n    cardCvv.mount(\"#card-cvv\");\r\n    cardPostalCode.mount(\"#card-postal-code\");\r\n\r\n    // Add event listeners for validation errors\r\n    const addEventListeners = (element, errorElementId, errorKey) => {\r\n      const displayError = document.getElementById(errorElementId);\r\n      element.addEventListener(\"change\", function (event) {\r\n        displayError.innerHTML = event[errorKey].error || \"\";\r\n      });\r\n      element.addEventListener(\"blur\", function (event) {\r\n        displayError.innerHTML = event[errorKey].error || \"\";\r\n      });\r\n    };\r\n\r\n    addEventListeners(cardNumber, \"card-number-errors\", \"CARD_NUMBER\");\r\n    addEventListeners(cardName, \"card-name-errors\", \"CARD_NAME\");\r\n    addEventListeners(cardDate, \"card-date-errors\", \"CARD_DATE\");\r\n    addEventListeners(cardCvv, \"card-cvv-errors\", \"CARD_CVV\");\r\n    addEventListeners(\r\n      cardPostalCode,\r\n      \"card-postal-code-errors\",\r\n      \"CARD_POSTAL_CODE\"\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!order || order._id !== Number(orderId)) {\r\n     // dispatch({ type: ORDER_PAY_RESET });\r\n      dispatch(useListOrderDetailsQuery.initiate(orderId));\r\n    } else if (!order.isPaid) {\r\n      if (!sdkReady) {\r\n        addCloverScript();\r\n      }\r\n    }\r\n  }, [dispatch, order, orderId, sdkReady]);\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (clover) {\r\n      try {\r\n        const result = await clover.createToken();\r\n        if (result.errors) {\r\n          Object.values(result.errors).forEach((value) => {\r\n            console.log(value);\r\n          });\r\n        } else {\r\n          const token = await result.token;\r\n          setOrderData({\r\n            ...orderData,\r\n            _id: orderId,\r\n            source: token\r\n          })\r\n          alert(token);\r\n          usePayOrderMutation.initiate(orderData);\r\n          //createCharge(token);\r\n        }\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  /*\r\n  form.addEventListener(\"submit\", function (event) {\r\n    event.preventDefault();\r\n    clover\r\n      .createToken()\r\n      .then(async function (result) {\r\n        if (result.errors) {\r\n          Object.values(result.errors).forEach(function (value) {\r\n            console.log(value);\r\n          });\r\n        } else {\r\n          const token = await result.token;\r\n          alert(token);\r\n          //cloverTokenHandler(token);\r\n          createCharge(token);\r\n        }\r\n      })\r\n      .catch(function (data) {\r\n        console.log(data);\r\n      });\r\n  });\r\n\r\n*/\r\n\r\n  //use token as parameter in a create charge function\r\n  const createCharge = (token) => {\r\n    fetch(\"/charge\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        amount: 1000,\r\n        source: token,\r\n      }),\r\n    })\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        alert(JSON.stringify(data));\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error: \", error);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <SEO\r\n        titleTemplate=\"Checkout\"\r\n        description=\"Clover Secure Payment Page for The Cage SShop\"\r\n      />\r\n      <LayoutOne headerTop=\"visibile\">\r\n        {/*breadcrumb*/}\r\n        <Breadcrumb\r\n          pages={[\r\n            { label: \"Home\", path: process.env.PUBLIC_URL + \"/\" },\r\n            { label: \"Checkout\", path: process.env.PUBLIC_URL + pathname },\r\n          ]}\r\n          backgroundImage=\"/assets/img/bg/breadcrumb.png\"\r\n        />\r\n        <div class=\"container\">\r\n          <form\r\n            action=\"/charge\"\r\n            method=\"post\"\r\n            id=\"payment-form\"\r\n            onSubmit={handleSubmit}\r\n          >\r\n            <div class=\"form-row top-row\">\r\n              <div id=\"card-number\" class=\"field card-number\"></div>\r\n              <div\r\n                class=\"input-errors\"\r\n                id=\"card-number-errors\"\r\n                role=\"alert\"\r\n              ></div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div id=\"card-name\" class=\"field card-name\"></div>\r\n              <div\r\n                class=\"input-errors\"\r\n                id=\"card-name-errors\"\r\n                role=\"alert\"\r\n              ></div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div id=\"card-date\" class=\"field card-date\"></div>\r\n              <div\r\n                class=\"input-errors\"\r\n                id=\"card-date-errors\"\r\n                role=\"alert\"\r\n              ></div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div id=\"card-cvv\" class=\"field card-cvv\"></div>\r\n              <div class=\"input-errors\" id=\"card-cvv-errors\" role=\"alert\"></div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div id=\"card-postal-code\" class=\"field card-postal-code\"></div>\r\n              <div\r\n                class=\"input-errors\"\r\n                id=\"card-postal-code-errors\"\r\n                role=\"alert\"\r\n              ></div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div\r\n                id=\"card-street-address\"\r\n                class=\"field card-street-address\"\r\n              ></div>\r\n              <div\r\n                class=\"input-errors\"\r\n                id=\"card-street-address-errors\"\r\n                role=\"alert\"\r\n              ></div>\r\n            </div>\r\n\r\n            {/*<!--Card Response-->*/}\r\n            <div id=\"card-response\" role=\"alert\"></div>\r\n            {/*<!--Button Container-->*/}\r\n            <div class=\"button-container\">\r\n              <button id=\"submit_button\">Submit Payment</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </LayoutOne>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default CloverPayment;\r\n"],"names":["dispatch","useDispatch","pathname","useLocation","orderId","useParams","orderDetails","useListOrderDetailsQuery","order","_useState","error","loading","useState","_useState2","_slicedToArray","sdkReady","setSdkReady","_useState3","_useState4","clover","setClover","_useState5","_id","source","_useState6","orderData","setOrderData","initializeClover","apiKey","process","CLOVER_API_KEY","cloverInstance","window","Clover","merchantId","CLOVER_MERCHANT_ID","elements","cardNumber","create","cardName","cardDate","cardCvv","cardPostalCode","mount","addEventListeners","element","errorElementId","errorKey","displayError","document","getElementById","addEventListener","event","innerHTML","useEffect","Number","isPaid","script","createElement","type","src","async","onload","body","appendChild","addCloverScript","initiate","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","result","token","wrap","_context","prev","next","preventDefault","createToken","sent","errors","Object","values","forEach","value","console","log","_objectSpread","alert","usePayOrderMutation","t0","stop","_x","apply","arguments","_jsxs","Fragment","children","_jsx","SEO","titleTemplate","description","LayoutOne","headerTop","Breadcrumb","pages","label","path","backgroundImage","class","action","method","id","onSubmit","role"],"sourceRoot":""}